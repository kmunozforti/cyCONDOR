<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Batch correction â€¢ cyCONDOR</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Batch correction">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cyCONDOR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/cyCONDOR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Prepare_data_for_cyCONDOR_analysis.html">Prepare data for cyCONDOR analysis</a></li>
    <li><a class="dropdown-item" href="../articles/How_to_run_cyCONDOR_as_container.html">How to run cyCONDOR as container</a></li>
    <li><a class="dropdown-item" href="../articles/Data_Loading_and_Transformation.html">Data Loading and Transformation</a></li>
    <li><a class="dropdown-item" href="../articles/Load_a_FlowJo_workspace.html">Load a FlowJo workspace</a></li>
    <li><a class="dropdown-item" href="../articles/Dimensionality_Reduction.html">Dimensionality Reduction</a></li>
    <li><a class="dropdown-item" href="../articles/Clustering_and_cell_annotation.html">Clustering and cell annotation</a></li>
    <li><a class="dropdown-item" href="../articles/Batch_correction.html">Batch correction</a></li>
    <li><a class="dropdown-item" href="../articles/Data_Visualization.html">Data Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/Differential_Analysis.html">Differential Analysis with cyCONDOR</a></li>
    <li><a class="dropdown-item" href="../articles/Pseudotime_analysis.html">Pseudotime analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Data_Projection.html">Data Projection</a></li>
    <li><a class="dropdown-item" href="../articles/Machine_learning_classifier.html">Machine learning classifier</a></li>
    <li><a class="dropdown-item" href="../articles/Cell_type_prediction.html">Cell type prediction</a></li>
    <li><a class="dropdown-item" href="../articles/Other_utilities.html">Introduction to the condor object and other utilities</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lorenzobonaguro/cyCONDOR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Batch correction</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lorenzobonaguro/cyCONDOR/blob/HEAD/vignettes/Batch_correction.Rmd" class="external-link"><code>vignettes/Batch_correction.Rmd</code></a></small>
      <div class="d-none name"><code>Batch_correction.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lorenzobonaguro.github.io/cyCONDOR" class="external-link">cyCONDOR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/VPetukhov/ggrastr" class="external-link">ggrastr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">lisi</span><span class="op">)</span></span></code></pre></div>
<p>In this vignette we exemplify a workflow to correct for a batch
effect induced by performing experiments (including cell preparation,
staining and recording of flow cytometry data) on different dates. The
example data set used in this vignette consists of peripheral blood
mononuclear cells (PBMCs) from healthy donors.</p>
<div class="section level2">
<h2 id="cycondor-dimensionality-reduction-workflow">1 cyCONDOR dimensionality reduction workflow<a class="anchor" aria-label="anchor" href="#cycondor-dimensionality-reduction-workflow"></a>
</h2>
<p>This first part describes the general <code>cyCONDOR</code> data
processing and dimensionality reduction workflow (see
<code>vignettes("Data loading and transformation")</code> and
<code>vignettes("Dimensionality Reduction")</code> for more details)
until the closer inspection of the data set and identification of a
technical batch effect.</p>
<div class="section level3">
<h3 id="loading-the-data">Loading the data<a class="anchor" aria-label="anchor" href="#loading-the-data"></a>
</h3>
<p>We start by loading the data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_fcd.html">prep_fcd</a></span><span class="op">(</span>data_path <span class="op">=</span> <span class="st">"../.test_files/BatchCorrection/all/"</span>,</span>
<span>                   max_cell <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                   useCSV <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                   transformation <span class="op">=</span> <span class="st">"auto_logi"</span>,</span>
<span>                   remove_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"FSC-H"</span>, <span class="st">"SSC-H"</span><span class="op">)</span>,</span>
<span>                   anno_table <span class="op">=</span> <span class="st">"../.test_files/BatchCorrection/all.csv"</span>,</span>
<span>                   filename_col <span class="op">=</span> <span class="st">"filename"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set the date as factor for visualization purposes</span></span>
<span><span class="va">condor</span><span class="op">$</span><span class="va">anno</span><span class="op">$</span><span class="va">cell_anno</span><span class="op">$</span><span class="va">exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">condor</span><span class="op">$</span><span class="va">anno</span><span class="op">$</span><span class="va">cell_anno</span><span class="op">$</span><span class="va">exp</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dimensionality-reduction">Dimensionality Reduction<a class="anchor" aria-label="anchor" href="#dimensionality-reduction"></a>
</h3>
<p>Next, we perform dimensionality reduction calculating the principal
components (PCs) and the UMAP based on the PCs.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runPCA.html">runPCA</a></span><span class="op">(</span>fcd <span class="op">=</span> <span class="va">condor</span>, </span>
<span>                 data_slot <span class="op">=</span> <span class="st">"orig"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">condor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runUMAP.html">runUMAP</a></span><span class="op">(</span>fcd <span class="op">=</span> <span class="va">condor</span>, </span>
<span>                  input_type <span class="op">=</span> <span class="st">"pca"</span>, </span>
<span>                  data_slot <span class="op">=</span> <span class="st">"orig"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="inspection-of-batch-effect">Inspection of batch effect<a class="anchor" aria-label="anchor" href="#inspection-of-batch-effect"></a>
</h3>
<p>We can now visualize the batch effect in this data set by plotting
the UMAP coordinates and coloring the cells by the experiment date.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dim_red.html">plot_dim_red</a></span><span class="op">(</span>fcd<span class="op">=</span> <span class="va">condor</span>,  </span>
<span>             reduction_method <span class="op">=</span> <span class="st">"umap"</span>, </span>
<span>             reduction_slot <span class="op">=</span> <span class="st">"pca_orig"</span>, </span>
<span>             param <span class="op">=</span> <span class="st">"exp"</span>, </span>
<span>             title <span class="op">=</span> <span class="st">"Original UMAP"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Batch_correction_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dim_red.html">plot_dim_red</a></span><span class="op">(</span>fcd<span class="op">=</span> <span class="va">condor</span>,  </span>
<span>             reduction_method <span class="op">=</span> <span class="st">"umap"</span>, </span>
<span>             reduction_slot <span class="op">=</span> <span class="st">"pca_orig"</span>, </span>
<span>             param <span class="op">=</span> <span class="st">"exp"</span>, </span>
<span>             title <span class="op">=</span> <span class="st">"Original UMAP"</span>,</span>
<span>             facet_by_variable <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Batch_correction_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="batch-correction">2 Batch correction<a class="anchor" aria-label="anchor" href="#batch-correction"></a>
</h2>
<p>Within the <code>cyCONDOR</code> ecosystem we implemented <a href="https://doi.org/10.1038/s41592-019-0619-0" class="external-link">harmony</a> and <a href="https://doi.org/10.1002/cyto.a.23904" class="external-link">CytoNorm</a> for batch
correction. The correction can be applied either to the protein
expression values (fluorescence intensities) or to the principal
components. There is no â€˜magic bulletâ€™ for batch correction and each of
these methods needs to be used with care to correct for the batch effect
but not the underlying biological effects. Therefore, each of the here
described methods should always be validated by inspecting the
expression of hallmark markers.</p>
<p>If you use this workflow in your work please consider citing <a href="XXX">cyCONDOR</a> and <a href="https://doi.org/10.1038/s41592-019-0619-0" class="external-link">harmony</a> or <a href="https://doi.org/10.1002/cyto.a.23904" class="external-link">CytoNorm</a>.</p>
<div class="section level3">
<h3 id="correct-principal-components">2.1 Correct Principal Components<a class="anchor" aria-label="anchor" href="#correct-principal-components"></a>
</h3>
<p>To use the <code>harmony</code> algorithm for correcting the
principal components, we use the <code><a href="../reference/harmonize_PCA.html">harmonize_PCA()</a></code> and define
the batch variable <code>batch_var</code>, in this example the
experiment date â€˜expâ€™.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/harmonize_PCA.html">harmonize_PCA</a></span><span class="op">(</span>fcd <span class="op">=</span> <span class="va">condor</span>, </span>
<span>                        batch_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span><span class="op">)</span>, </span>
<span>                        data_slot <span class="op">=</span> <span class="st">"orig"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Transposing data matrix</span></span></code></pre>
<pre><code><span><span class="co">## Initializing state using k-means centroids initialization</span></span></code></pre>
<pre><code><span><span class="co">## Harmony 1/10</span></span></code></pre>
<pre><code><span><span class="co">## Harmony 2/10</span></span></code></pre>
<pre><code><span><span class="co">## Harmony 3/10</span></span></code></pre>
<pre><code><span><span class="co">## Harmony converged after 3 iterations</span></span></code></pre>
<p>The harmonized PCs are saved in <code>condor$pca$norm</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor</span><span class="op">$</span><span class="va">pca</span><span class="op">$</span><span class="va">norm</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##                                                                           PC1</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_1  -1.1377724</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_2   3.6662881</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_3   2.4006793</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_4   0.1994315</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_5   3.6988799</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_6   3.7043739</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_7   2.5619230</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_8  -2.7855854</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_9   1.8170364</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_10  4.0291312</span></span>
<span><span class="co">##                                                                           PC2</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_1  -3.4642730</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_2   1.5051951</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_3  -0.1952621</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_4  -1.0485322</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_5  -0.1292137</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_6   0.7853718</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_7   1.2301255</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_8   1.0542023</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_9  -2.3273341</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_10  0.6140877</span></span>
<span><span class="co">##                                                                           PC3</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_1  -1.6885949</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_2   0.3368425</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_3   0.5490619</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_4  -0.1086231</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_5  -0.1193580</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_6   0.5634436</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_7  -0.7273368</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_8  -0.6713721</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_9  -1.0218579</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_10  0.7951340</span></span>
<span><span class="co">##                                                                            PC4</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_1   1.89605907</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_2  -0.71224125</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_3   2.50342900</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_4   0.79742800</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_5   0.81283079</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_6   0.73554764</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_7   0.62596763</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_8  -0.83265025</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_9   0.19543499</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_10 -0.07020503</span></span>
<span><span class="co">##                                                                            PC5</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_1   0.95653887</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_2   0.28052891</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_3   1.47298748</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_4  -2.31488868</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_5   1.22041393</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_6  -0.34905325</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_7   1.03657568</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_8   0.73296934</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_9  -1.72791133</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_10  0.03643929</span></span></code></pre>
<div class="section level4">
<h4 id="repeat-dimensionality-reduction">Repeat dimensionality reduction<a class="anchor" aria-label="anchor" href="#repeat-dimensionality-reduction"></a>
</h4>
<p>We can now recalculate the UMAP based on the harmonized PCs. For this
we select <code>input_type = "pca"</code> and
<code>data_slot = "norm"</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runUMAP.html">runUMAP</a></span><span class="op">(</span>fcd <span class="op">=</span> <span class="va">condor</span>, </span>
<span>                  input_type <span class="op">=</span> <span class="st">"pca"</span>, </span>
<span>                  data_slot <span class="op">=</span> <span class="st">"norm"</span>,</span>
<span>                  prefix<span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p>Unless a prefix has been set, the new UMAP coordinates calculated
based on the harmonized PCs can be accessed via
<code>condor$umap$pca_norm</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor</span><span class="op">$</span><span class="va">umap</span><span class="op">$</span><span class="va">pca_norm</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##                                                                      UMAP1</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_1 3.710886</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_2 9.692592</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_3 7.363851</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_4 3.840179</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_5 6.542572</span></span>
<span><span class="co">##                                                                       UMAP2</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_1  7.799647</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_2 -6.828268</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_3 -7.482562</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_4  2.904735</span></span>
<span><span class="co">## 20230322_AB_20220406_DH_193223821_193363_E2_Live_cells_comp.fcs_5 -6.905147</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="visualization-of-the-data-integration-results">Visualization of the data integration results<a class="anchor" aria-label="anchor" href="#visualization-of-the-data-integration-results"></a>
</h4>
<div class="section level5">
<h5 id="umap">UMAP<a class="anchor" aria-label="anchor" href="#umap"></a>
</h5>
<p>For a first inspection of the data integration, we can visualize the
results by plotting the new UMAP coordinates and coloring the cells by
the experiment date. The UMAP shows no strong separation of the cells by
the experiment date anymore. To further inspect the data integration
results, the expression of cell type lineage markers should be assessed.
This is highly dependent on the markers measured in the flow cytometry
data set and therefore not included in this vignette.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dim_red.html">plot_dim_red</a></span><span class="op">(</span>fcd<span class="op">=</span> <span class="va">condor</span>,  </span>
<span>             reduction_method <span class="op">=</span> <span class="st">"umap"</span>, </span>
<span>             reduction_slot <span class="op">=</span> <span class="st">"pca_norm"</span>, </span>
<span>             param <span class="op">=</span> <span class="st">"exp"</span>, </span>
<span>             title <span class="op">=</span> <span class="st">"Harmonized UMAP"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Batch_correction_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dim_red.html">plot_dim_red</a></span><span class="op">(</span>fcd<span class="op">=</span> <span class="va">condor</span>,  </span>
<span>             reduction_method <span class="op">=</span> <span class="st">"umap"</span>, </span>
<span>             reduction_slot <span class="op">=</span> <span class="st">"pca_norm"</span>, </span>
<span>             param <span class="op">=</span> <span class="st">"exp"</span>, </span>
<span>             title <span class="op">=</span> <span class="st">"Harmonized UMAP"</span>,</span>
<span>             facet<span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Batch_correction_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="lisi-score">LISI score<a class="anchor" aria-label="anchor" href="#lisi-score"></a>
</h5>
<p>To further inspect the data integration result, we can calculate the
<a href="https://doi.org/10.1038/s41592-019-0619-0" class="external-link">Local Inverse
Simpsonâ€™s Index (LISI) score</a>. The LISI score can be used to assess
the degree of mixing among the cells from the different batches in the
UMAP space.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#prepare pre batch correction data set</span></span>
<span><span class="va">pre_batch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">condor</span><span class="op">$</span><span class="va">umap</span><span class="op">$</span><span class="va">pca_orig</span>, <span class="va">condor</span><span class="op">$</span><span class="va">anno</span><span class="op">$</span><span class="va">cell_anno</span><span class="op">)</span></span>
<span><span class="co">#calculate LISI score for batch variable 'exp'</span></span>
<span><span class="va">res_pre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lisi/man/compute_lisi.html" class="external-link">compute_lisi</a></span><span class="op">(</span><span class="va">pre_batch</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span>, <span class="va">pre_batch</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'exp'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">res_pre</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"lisi"</span></span>
<span><span class="co">#combine LISI score with cell annotation</span></span>
<span><span class="va">lisi_mat_pre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">pre_batch</span>, <span class="va">res_pre</span><span class="op">)</span></span>
<span><span class="va">lisi_mat_pre</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"pre"</span></span>
<span></span>
<span><span class="co">#prepare ppost batch correction data set</span></span>
<span><span class="va">post_batch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">condor</span><span class="op">$</span><span class="va">umap</span><span class="op">$</span><span class="va">pca_norm</span>, <span class="va">condor</span><span class="op">$</span><span class="va">anno</span><span class="op">$</span><span class="va">cell_anno</span><span class="op">)</span></span>
<span><span class="co">#calculate LISI score for batch variable 'exp'</span></span>
<span><span class="va">res_post</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lisi/man/compute_lisi.html" class="external-link">compute_lisi</a></span><span class="op">(</span><span class="va">post_batch</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span>, <span class="va">post_batch</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'exp'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">res_post</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"lisi"</span></span>
<span><span class="co">#combine LISI score with cell annotation</span></span>
<span><span class="va">lisi_mat_post</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">post_batch</span>, <span class="va">res_post</span><span class="op">)</span></span>
<span><span class="va">lisi_mat_post</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"post"</span></span>
<span></span>
<span><span class="co">#combine pre and post batch matrices </span></span>
<span><span class="va">lisi_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">lisi_mat_post</span>, <span class="va">lisi_mat_pre</span><span class="op">)</span></span>
<span><span class="va">lisi_mat</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">lisi_mat</span><span class="op">$</span><span class="va">type</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pre"</span>, <span class="st">"post"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#visualization </span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lisi_mat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">lisi</span>, x <span class="op">=</span> <span class="va">type</span>, fill <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ggrastr/man/geom_jitter_rast.html" class="external-link">geom_jitter_rast</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.01</span>, scale <span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#1C75BC"</span>, <span class="st">"#BE1E2D"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">2</span>, panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        text<span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span>, color<span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"LISI score"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="Batch_correction_files/figure-html/unnamed-chunk-11-1.png" width="480"></p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="correct-fluorescent-intensities">2.2 Correct fluorescent intensities<a class="anchor" aria-label="anchor" href="#correct-fluorescent-intensities"></a>
</h3>
<p>As an alternative to correcting the embedding, the fluorescent
intensities can be directly corrected using <code>harmony</code> or
<code>CytoNorm</code>. However, direct correction of fluorescence
intensities should be used with caution, if biological differences
between groups or conditions are planned to be compared in the
downstream analysis.</p>
<div class="section level4">
<h4 id="correct-fluorescent-intensities-with-harmony">Correct fluorescent intensities with harmony<a class="anchor" aria-label="anchor" href="#correct-fluorescent-intensities-with-harmony"></a>
</h4>
<p>To use the <code>harmony</code> algorithm for correcting the
intensities, we use the <code><a href="../reference/harmonize_intensities.html">harmonize_intensities()</a></code> and define
the batch variable <code>batch_var</code>, in this case â€˜expâ€™.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/harmonize_intensities.html">harmonize_intensities</a></span><span class="op">(</span>fcd <span class="op">=</span> <span class="va">condor</span>, </span>
<span>                                batch_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Transposing data matrix</span></span></code></pre>
<pre><code><span><span class="co">## Initializing state using k-means centroids initialization</span></span></code></pre>
<pre><code><span><span class="co">## Harmony 1/10</span></span></code></pre>
<pre><code><span><span class="co">## Harmony 2/10</span></span></code></pre>
<pre><code><span><span class="co">## Harmony 3/10</span></span></code></pre>
<pre><code><span><span class="co">## Harmony converged after 3 iterations</span></span></code></pre>
<p>The harmonized intensities are saved in
<code>condor$expr$norm</code>.</p>
</div>
<div class="section level4">
<h4 id="correct-fluorescent-intensities-with-cytonorm">Correct fluorescent intensities with CytoNorm<a class="anchor" aria-label="anchor" href="#correct-fluorescent-intensities-with-cytonorm"></a>
</h4>
<p>Another approach for correcting the fluorescence intensities is the
application of the <a href="https://github.com/saeyslab/CytoNorm" class="external-link">CytoNorm algorithm</a>
within the <code>cyCONDOR</code> ecosystem. For a detailed description
of <code>CytoNorm</code> see <a href="https://doi.org/10.1002/cyto.a.23904" class="external-link">Van Gassen et al.,
2019</a>.</p>
<p>As a first step, the batch effect is learnt from reference samples
provided by the user. The control samples should contain the whole range
of expression values of the markers in the panel. For example in the
case of a stimulation experiment including unstimulated and stimulated
samples as control samples improved estimation of the batch effect (<a href="https://doi.org/10.1002/cyto.a.23904" class="external-link">Van Gassen et al.,
2019</a>). Ideally the samples used as reference samples were stained
and recorded along the other samples within each batch. Depending on
your data set, it is also possible to use all samples contained in your
data set as reference samples to train the model and learn the
differences between the batches as shown in the example below.</p>
<div class="section level5">
<h5 id="training-the-model">Training the model<a class="anchor" aria-label="anchor" href="#training-the-model"></a>
</h5>
<p>Here, a model is trained on all samples contained in the data set.
For this we need to provide the name of the batch variable
<code>batch_var</code> and optionally parameters which should not be
included for the training as well as different parameters for clustering
the cells with FlowSOM (<code>FlowSom_param</code>). Here, we use all
markers present in the <code>fcd</code> and perform the training with
the default parameters for <code>FlowSom_param</code>. The number of
desired FlowSOM metaclusters is defined by <code>nClus</code> and should
be adjusted according to your data set, see <a href="https://doi.org/10.1002/cyto.a.23904" class="external-link">Van Gassen et al., 2019</a>
for more details.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/train_cytonorm.html">train_cytonorm</a></span><span class="op">(</span>fcd <span class="op">=</span> <span class="va">condor</span>,</span>
<span>                         batch_var <span class="op">=</span> <span class="st">"exp"</span>,</span>
<span>                         remove_param <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                         FlowSOM_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nCells <span class="op">=</span> <span class="fl">5000</span>, xdim <span class="op">=</span> <span class="fl">5</span>, ydim <span class="op">=</span> <span class="fl">5</span>, nClus <span class="op">=</span> <span class="fl">10</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, </span>
<span>                         seed <span class="op">=</span> <span class="fl">91</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="normalization-of-data-with-trained-model">Normalization of data with trained model<a class="anchor" aria-label="anchor" href="#normalization-of-data-with-trained-model"></a>
</h5>
<p>Next the trained model saved within your <code>fcd</code> is used to
normalize all samples present in your <code>fcd</code>. The fcs files
with the normalized expression values can be saved, if
<code>keep_fcs</code> is set to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_cytonorm.html">run_cytonorm</a></span><span class="op">(</span>fcd <span class="op">=</span> <span class="va">condor</span>,</span>
<span>                       files <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                       batch_var <span class="op">=</span> <span class="st">"exp"</span>,</span>
<span>                       keep_fcs <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## start normalization</span></span></code></pre>
<pre><code><span><span class="co">## adding normalized expression data to fcd</span></span></code></pre>
<pre><code><span><span class="co">## removing temporary fcs files</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">info</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.4.2 (2024-10-31)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 24.04.1 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Etc/UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] lisi_1.0       ggrastr_1.0.2  ggplot2_3.5.2  cyCONDOR_0.3.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] IRanges_2.40.1              Rmisc_1.5.1                </span></span>
<span><span class="co">##   [3] urlchecker_1.0.1            nnet_7.3-20                </span></span>
<span><span class="co">##   [5] CytoNorm_2.0.1              TH.data_1.1-3              </span></span>
<span><span class="co">##   [7] vctrs_0.6.5                 digest_0.6.37              </span></span>
<span><span class="co">##   [9] png_0.1-8                   shape_1.4.6.1              </span></span>
<span><span class="co">##  [11] proxy_0.4-27                slingshot_2.14.0           </span></span>
<span><span class="co">##  [13] ggrepel_0.9.6               corrplot_0.95              </span></span>
<span><span class="co">##  [15] parallelly_1.45.0           MASS_7.3-65                </span></span>
<span><span class="co">##  [17] pkgdown_2.1.3               reshape2_1.4.4             </span></span>
<span><span class="co">##  [19] httpuv_1.6.16               foreach_1.5.2              </span></span>
<span><span class="co">##  [21] BiocGenerics_0.52.0         withr_3.0.2                </span></span>
<span><span class="co">##  [23] xfun_0.52                   ggpubr_0.6.1               </span></span>
<span><span class="co">##  [25] ellipsis_0.3.2              survival_3.8-3             </span></span>
<span><span class="co">##  [27] memoise_2.0.1               hexbin_1.28.5              </span></span>
<span><span class="co">##  [29] ggbeeswarm_0.7.2            RProtoBufLib_2.18.0        </span></span>
<span><span class="co">##  [31] princurve_2.1.6             profvis_0.4.0              </span></span>
<span><span class="co">##  [33] ggsci_3.2.0                 systemfonts_1.2.3          </span></span>
<span><span class="co">##  [35] ragg_1.4.0                  zoo_1.8-14                 </span></span>
<span><span class="co">##  [37] GlobalOptions_0.1.2         DEoptimR_1.1-3-1           </span></span>
<span><span class="co">##  [39] Formula_1.2-5               promises_1.3.3             </span></span>
<span><span class="co">##  [41] scatterplot3d_0.3-44        httr_1.4.7                 </span></span>
<span><span class="co">##  [43] rstatix_0.7.2               globals_0.18.0             </span></span>
<span><span class="co">##  [45] rstudioapi_0.17.1           UCSC.utils_1.2.0           </span></span>
<span><span class="co">##  [47] miniUI_0.1.2                generics_0.1.4             </span></span>
<span><span class="co">##  [49] ggcyto_1.34.0               base64enc_0.1-3            </span></span>
<span><span class="co">##  [51] curl_6.4.0                  S4Vectors_0.44.0           </span></span>
<span><span class="co">##  [53] zlibbioc_1.52.0             flowWorkspace_4.18.1       </span></span>
<span><span class="co">##  [55] polyclip_1.10-7             randomForest_4.7-1.2       </span></span>
<span><span class="co">##  [57] GenomeInfoDbData_1.2.13     SparseArray_1.6.2          </span></span>
<span><span class="co">##  [59] RBGL_1.82.0                 ncdfFlow_2.52.1            </span></span>
<span><span class="co">##  [61] RcppEigen_0.3.4.0.2         xtable_1.8-4               </span></span>
<span><span class="co">##  [63] stringr_1.5.1               desc_1.4.3                 </span></span>
<span><span class="co">##  [65] doParallel_1.0.17           evaluate_1.0.4             </span></span>
<span><span class="co">##  [67] S4Arrays_1.6.0              hms_1.1.3                  </span></span>
<span><span class="co">##  [69] glmnet_4.1-9                GenomicRanges_1.58.0       </span></span>
<span><span class="co">##  [71] irlba_2.3.5.1               colorspace_2.1-1           </span></span>
<span><span class="co">##  [73] harmony_1.2.3               reticulate_1.42.0          </span></span>
<span><span class="co">##  [75] readxl_1.4.5                magrittr_2.0.3             </span></span>
<span><span class="co">##  [77] lmtest_0.9-40               readr_2.1.5                </span></span>
<span><span class="co">##  [79] Rgraphviz_2.50.0            later_1.4.2                </span></span>
<span><span class="co">##  [81] lattice_0.22-7              future.apply_1.20.0        </span></span>
<span><span class="co">##  [83] robustbase_0.99-4-1         XML_3.99-0.18              </span></span>
<span><span class="co">##  [85] cowplot_1.2.0               matrixStats_1.5.0          </span></span>
<span><span class="co">##  [87] RcppAnnoy_0.0.22            xts_0.14.1                 </span></span>
<span><span class="co">##  [89] class_7.3-23                Hmisc_5.2-3                </span></span>
<span><span class="co">##  [91] pillar_1.11.0               nlme_3.1-168               </span></span>
<span><span class="co">##  [93] iterators_1.0.14            compiler_4.4.2             </span></span>
<span><span class="co">##  [95] RSpectra_0.16-2             stringi_1.8.7              </span></span>
<span><span class="co">##  [97] gower_1.0.2                 minqa_1.2.8                </span></span>
<span><span class="co">##  [99] SummarizedExperiment_1.36.0 lubridate_1.9.4            </span></span>
<span><span class="co">## [101] devtools_2.4.5              CytoML_2.18.3              </span></span>
<span><span class="co">## [103] plyr_1.8.9                  crayon_1.5.3               </span></span>
<span><span class="co">## [105] abind_1.4-8                 locfit_1.5-9.12            </span></span>
<span><span class="co">## [107] sp_2.2-0                    sandwich_3.1-1             </span></span>
<span><span class="co">## [109] pcaMethods_1.98.0           dplyr_1.1.4                </span></span>
<span><span class="co">## [111] codetools_0.2-20            multcomp_1.4-28            </span></span>
<span><span class="co">## [113] textshaping_1.0.1           recipes_1.3.1              </span></span>
<span><span class="co">## [115] openssl_2.3.3               Rphenograph_0.99.1         </span></span>
<span><span class="co">## [117] TTR_0.24.4                  bslib_0.9.0                </span></span>
<span><span class="co">## [119] e1071_1.7-16                destiny_3.20.0             </span></span>
<span><span class="co">## [121] GetoptLong_1.0.5            ggplot.multistats_1.0.1    </span></span>
<span><span class="co">## [123] mime_0.13                   splines_4.4.2              </span></span>
<span><span class="co">## [125] circlize_0.4.16             Rcpp_1.1.0                 </span></span>
<span><span class="co">## [127] sparseMatrixStats_1.18.0    cellranger_1.1.0           </span></span>
<span><span class="co">## [129] knitr_1.50                  clue_0.3-66                </span></span>
<span><span class="co">## [131] lme4_1.1-37                 fs_1.6.6                   </span></span>
<span><span class="co">## [133] listenv_0.9.1               checkmate_2.3.2            </span></span>
<span><span class="co">## [135] DelayedMatrixStats_1.28.1   Rdpack_2.6.4               </span></span>
<span><span class="co">## [137] pkgbuild_1.4.8              ggsignif_0.6.4             </span></span>
<span><span class="co">## [139] tibble_3.3.0                Matrix_1.7-3               </span></span>
<span><span class="co">## [141] rpart.plot_3.1.2            statmod_1.5.0              </span></span>
<span><span class="co">## [143] tzdb_0.5.0                  tweenr_2.0.3               </span></span>
<span><span class="co">## [145] pkgconfig_2.0.3             pheatmap_1.0.13            </span></span>
<span><span class="co">## [147] tools_4.4.2                 cachem_1.1.0               </span></span>
<span><span class="co">## [149] RhpcBLASctl_0.23-42         rbibutils_2.3              </span></span>
<span><span class="co">## [151] smoother_1.3                fastmap_1.2.0              </span></span>
<span><span class="co">## [153] rmarkdown_2.29              scales_1.4.0               </span></span>
<span><span class="co">## [155] grid_4.4.2                  usethis_3.1.0              </span></span>
<span><span class="co">## [157] broom_1.0.8                 sass_0.4.10                </span></span>
<span><span class="co">## [159] graph_1.84.1                carData_3.0-5              </span></span>
<span><span class="co">## [161] RANN_2.6.2                  rpart_4.1.24               </span></span>
<span><span class="co">## [163] farver_2.1.2                reformulas_0.4.1           </span></span>
<span><span class="co">## [165] yaml_2.3.10                 MatrixGenerics_1.18.1      </span></span>
<span><span class="co">## [167] foreign_0.8-90              ggthemes_5.1.0             </span></span>
<span><span class="co">## [169] cli_3.6.5                   purrr_1.1.0                </span></span>
<span><span class="co">## [171] stats4_4.4.2                lifecycle_1.0.4            </span></span>
<span><span class="co">## [173] uwot_0.2.3                  askpass_1.2.1              </span></span>
<span><span class="co">## [175] caret_7.0-1                 Biobase_2.66.0             </span></span>
<span><span class="co">## [177] mvtnorm_1.3-3               lava_1.8.1                 </span></span>
<span><span class="co">## [179] sessioninfo_1.2.3           backports_1.5.0            </span></span>
<span><span class="co">## [181] cytolib_2.18.2              timechange_0.3.0           </span></span>
<span><span class="co">## [183] gtable_0.3.6                rjson_0.2.23               </span></span>
<span><span class="co">## [185] umap_0.2.10.0               ggridges_0.5.6             </span></span>
<span><span class="co">## [187] parallel_4.4.2              pROC_1.18.5                </span></span>
<span><span class="co">## [189] limma_3.62.2                jsonlite_2.0.0             </span></span>
<span><span class="co">## [191] edgeR_4.4.2                 RcppHNSW_0.6.0             </span></span>
<span><span class="co">## [193] Rtsne_0.17                  FlowSOM_2.14.0             </span></span>
<span><span class="co">## [195] ranger_0.17.0               flowCore_2.18.0            </span></span>
<span><span class="co">## [197] jquerylib_0.1.4             timeDate_4041.110          </span></span>
<span><span class="co">## [199] shiny_1.11.1                ConsensusClusterPlus_1.70.0</span></span>
<span><span class="co">## [201] htmltools_0.5.8.1           diffcyt_1.26.1             </span></span>
<span><span class="co">## [203] glue_1.8.0                  XVector_0.46.0             </span></span>
<span><span class="co">## [205] VIM_6.2.2                   gridExtra_2.3              </span></span>
<span><span class="co">## [207] boot_1.3-31                 TrajectoryUtils_1.14.0     </span></span>
<span><span class="co">## [209] igraph_2.1.4                R6_2.6.1                   </span></span>
<span><span class="co">## [211] tidyr_1.3.1                 SingleCellExperiment_1.28.1</span></span>
<span><span class="co">## [213] labeling_0.4.3              vcd_1.4-13                 </span></span>
<span><span class="co">## [215] cluster_2.1.8.1             pkgload_1.4.0              </span></span>
<span><span class="co">## [217] GenomeInfoDb_1.42.3         ipred_0.9-15               </span></span>
<span><span class="co">## [219] nloptr_2.2.1                DelayedArray_0.32.0        </span></span>
<span><span class="co">## [221] tidyselect_1.2.1            vipor_0.4.7                </span></span>
<span><span class="co">## [223] htmlTable_2.4.3             ggforce_0.5.0              </span></span>
<span><span class="co">## [225] CytoDx_1.26.0               car_3.1-3                  </span></span>
<span><span class="co">## [227] future_1.58.0               ModelMetrics_1.2.2.2       </span></span>
<span><span class="co">## [229] laeken_0.5.3                data.table_1.17.8          </span></span>
<span><span class="co">## [231] htmlwidgets_1.6.4           ComplexHeatmap_2.22.0      </span></span>
<span><span class="co">## [233] RColorBrewer_1.1-3          rlang_1.1.6                </span></span>
<span><span class="co">## [235] remotes_2.5.0               colorRamps_2.3.4           </span></span>
<span><span class="co">## [237] Cairo_1.6-2                 ggnewscale_0.5.2           </span></span>
<span><span class="co">## [239] hardhat_1.4.1               beeswarm_0.4.0             </span></span>
<span><span class="co">## [241] prodlim_2025.04.28</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lorenzo Bonaguro, Charlotte Kroeger, Sophie Mueller, Jacqueline Leidner, Aleksej Frolov, Francesco Elli, Nico Henschel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
